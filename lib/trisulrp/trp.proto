// Trisul Remote Protocol (TRP) definition
// Based on Google Protocol Buffers
// (c) 2010-11, Unleash Networks (http://www.unleashnetworks.com)
// $Rev: 6946 $

option optimize_for = LITE_RUNTIME; 


package TRP;

message Timestamp  {
  required int64            tv_sec=1;
  optional int64            tv_usec=2 [default=0];
}

message TimeInterval  {
    required Timestamp      from=1;
    required Timestamp      to=2;
}

message StatsTuple {
    required Timestamp      ts=1; 
    required int64          val=2; 
}

message MeterValues {
    required int32          meter=1;
    repeated StatsTuple     values=2;
	optional int64			total=3;
	optional int64			seconds=4;
}

message MeterInfo {

	// from TrisulAPI 
	enum MeterType
	{
		VT_INVALID=0;
		VT_RATE_COUNTER_WITH_SLIDING_WINDOW=1;// this for top-N type counters
		VT_COUNTER=2;                         // basic counter, stores val in the raw
		VT_COUNTER_WITH_SLIDING_WINDOW=3;     // use this for top-N type counters
		VT_RATE_COUNTER=4;                    // rate counter stores val/sec
		VT_GAUGE=5;                           // basic gauge
		VT_GAUGE_MIN_MAX_AVG=6;               // gauge with 3 additional min/avg/max cols (auto)
		VT_AUTO=7;                            // automatic (eg, min/max/avg/stddev/)
		VT_RUNNING_COUNTER=8;                 // running counter, no delta calc 
        VT_AVERAGE=9;                 		  // average of samples, total/sampl uses 32bt|32bit
	}


    required int32          id=1;
    required MeterType      type=2;
    required int32	     	topcount=3;
	required string			name=4;
	optional string			description=5;
	optional string			units=6;
}

message KeyStats {
    optional int64          context=1[default=0];
    required string         counter_group=2;
    required string         key=3;
    repeated MeterValues    meters=4;
}

message KeyDetails {
    required string         key=1;
    optional string         label=2;
    optional string         description=3;
	optional int64			metric=4;
}

message SessionID {
    required int64          slice_id=1;
    required int64          session_id=2;
}

message AlertID {
    required int64          slice_id=1;
    required int64          alert_id=2;
}

message ResourceID {
    required int64          slice_id=1;
    required int64          resource_id=2;
}
message CounterGroupDetails {
    required string         guid=1;
    required string         name=2;
    optional int64          bucket_size=3;
    optional TimeInterval   time_interval=4;
    optional int64          topper_bucket_size=5;
	repeated MeterInfo		meters=6;
}

message SessionDetails  {
	optional string         session_key=1;
	required SessionID      session_id=2;
	optional string         user_label=3;
	required TimeInterval   time_interval=4;
	required int64          state=5;
	required int64          az_bytes=6;
	required int64          za_bytes=7;
	required int64          az_packets=8;
	required int64          za_packets=9;
	required KeyDetails     key1A=10;
	required KeyDetails     key2A=11;
	required KeyDetails     key1Z=12;
	required KeyDetails     key2Z=13;
	required KeyDetails     protocol=14;
	optional KeyDetails     nf_routerid=15;
	optional KeyDetails     nf_ifindex_in=16;
	optional KeyDetails     nf_ifindex_out=17;
	optional string		    tags=18;
	required int64          az_payload=19;
	required int64          za_payload=20;
	required int64          setup_rtt=21;
	required int64          retransmissions=22;
	optional int64		    tracker_statval=23;
}


message PDPDetails  {
	required SessionID      session_id=1;
	required string			ipa   = 2 ; 
	required string			msisdn   = 3 ;
	required string			imei   = 4 ;
	required string			imsi   = 5 ; 
	required string 		teidc1  = 6 ; 
	required string 		teidd1  = 7 ; 
	required string 		teidc2  = 8 ;
	required string 		teidd2  = 9 ;
	required string 		apn  = 10 ; 
	required string 		rai  = 11 ;
	required string 		uli  = 12 ;
	required string 		rat  = 13 ;
	required string 		cause  = 14 ; 
	required int64			stat0 = 15 ;
	required int64			stat1 = 16 ; 
	required TimeInterval   time_interval=18;
	optional string 		mccmnc  = 19 ;
	optional string 		trace   = 20 ;
}

enum AuthLevel {
    ADMIN=1;
    BASIC_USER=2;
    FORENSIC_USER=3;
    BLOCKED_USER=4;
}

enum CompressionType {
    UNCOMPRESSED=1;
    GZIP=2;
}

enum  PcapFormat {
    LIBPCAP=1;
    UNSNIFF=2;
}

enum PcapDisposition {
	DOWNLOAD=1;
	SAVE_ON_SERVER=2;
}

message Message {
    enum Command {  HELLO_REQUEST=1; 
                    HELLO_RESPONSE=2;
                    OK_RESPONSE=3;
                    ERROR_RESPONSE=5;
                    COUNTER_GROUP_REQUEST=6;
                    COUNTER_GROUP_RESPONSE=7;
                    COUNTER_ITEM_REQUEST=8;
                    COUNTER_ITEM_RESPONSE=9;
                    RELEASE_RESOURCE_REQUEST=10;
                    RELEASE_CONTEXT_REQUEST=11;
                    CONTROLLED_COUNTER_GROUP_REQUEST=12;
                    CONTROLLED_COUNTER_GROUP_RESPONSE=13;
                    FILTERED_DATAGRAMS_REQUEST=14;
                    FILTERED_DATAGRAMS_RESPONSE=15;
                    CONTROLLED_CONTEXT_REQUEST=16;
                    CONTROLLED_CONTEXT_RESPONSE=17;
                    SEARCH_KEYS_REQUEST=18;                   
                    SEARCH_KEYS_RESPONSE=19;                        
                    COUNTER_GROUP_INFO_REQUEST=20;              
                    COUNTER_GROUP_INFO_RESPONSE=21;             
                    SESSION_TRACKER_REQUEST=22;                     
                    SESSION_TRACKER_RESPONSE=23;                    
                    SESSION_ITEM_REQUEST=24;                      
                    SESSION_ITEM_RESPONSE=25;                     
                    BULK_COUNTER_ITEM_REQUEST=26;                     
                    BULK_COUNTER_ITEM_RESPONSE=27;                    
                    CGMONITOR_REQUEST=28;                             
                    CGMONITOR_RESPONSE=29;                            
                    TOPPER_SNAPSHOT_REQUEST=30;                       
                    TOPPER_SNAPSHOT_RESPONSE=31;                      
                    UPDATE_KEY_REQUEST=32;                            
                    UPDATE_KEY_RESPONSE=33;                           
                    QUERY_SESSIONS_REQUEST=34;                     
                    QUERY_SESSIONS_RESPONSE=35;
                    RING_STATS_REQUEST=36;          
                    RING_STATS_RESPONSE=37;                     
                    SERVER_STATS_REQUEST=38;                    
                    SERVER_STATS_RESPONSE=39;                              
                    SESSION_GROUP_REQUEST=40;
                    SESSION_GROUP_RESPONSE=41;
                    ALERT_ITEM_REQUEST=42;
                    ALERT_ITEM_RESPONSE=43;
                    ALERT_GROUP_REQUEST=44;
                    ALERT_GROUP_RESPONSE=45;
                    RESOURCE_ITEM_REQUEST=46;
                    RESOURCE_ITEM_RESPONSE=47;
                    RESOURCE_GROUP_REQUEST=48;
                    RESOURCE_GROUP_RESPONSE=49;
                    KEY_LOOKUP_REQUEST=50;
                    KEY_LOOKUP_RESPONSE=51;
					GREP_REQUEST=60;
					GREP_RESPONSE=61;
					KEYSPACE_REQUEST=70;
					KEYSPACE_RESPONSE=71;
					TOPPER_TREND_REQUEST=72;
					TOPPER_TREND_RESPONSE=73;
                    QUERY_PDP_REQUEST=74;                     
                    QUERY_PDP_RESPONSE=75;
                    STAB_PUBSUB_CTL=80;
    }

    required Command    trp_command=1;
    optional HelloRequest hello_request=2;
    optional HelloResponse hello_response=3;
    optional OKResponse ok_response=4;
    optional ErrorResponse error_response=5;
    optional CounterGroupRequest counter_group_request=6;
    optional CounterGroupResponse counter_group_response=7;
    optional CounterItemRequest counter_item_request=8;
    optional CounterItemResponse counter_item_response=9;
    optional ReleaseContextRequest release_context_request=11; 
    optional FilteredDatagramRequest filtered_datagram_request=14;
    optional FilteredDatagramResponse filtered_datagram_response=15;
    optional ControlledContextRequest controlled_context_request=16;
    optional ControlledContextResponse controlled_context_response=17;
    optional SearchKeysRequest search_keys_request=18;
    optional SearchKeysResponse search_keys_response=19;
    optional CounterGroupInfoRequest counter_group_info_request=20;
    optional CounterGroupInfoResponse counter_group_info_response=21;
    optional SessionItemRequest session_item_request=22;
    optional SessionItemResponse session_item_response=23;
    optional BulkCounterItemRequest bulk_counter_item_request=24;
    optional BulkCounterItemResponse bulk_counter_item_response=25;
    // optional TopperSnapshotRequest topper_snapshot_request=28; 
    // optional TopperSnapshotResponse topper_snapshot_response=29;
    optional UpdateKeyRequest update_key_request=30;
    optional QuerySessionsRequest query_sessions_request=31;
    optional QuerySessionsResponse  query_sessions_response=32;
    optional SessionTrackerRequest session_tracker_request=33;
    optional SessionTrackerResponse session_tracker_response=34;
    optional ServerStatsRequest server_stats_request=37;
    optional ServerStatsResponse server_stats_response=38;
    optional SessionGroupRequest session_group_request=39;
    optional SessionGroupResponse session_group_response=40;
    optional AlertItemRequest alert_item_request=41;
    optional AlertItemResponse alert_item_response=42;
    optional AlertGroupRequest alert_group_request=43;
    optional AlertGroupResponse alert_group_response=44;
    optional ResourceItemRequest resource_item_request=45;
    optional ResourceItemResponse resource_item_response=46;
    optional ResourceGroupRequest resource_group_request=47;
    optional ResourceGroupResponse resource_group_response=48;
    optional KeyLookupRequest key_lookup_request=49;
    optional KeyLookupResponse key_lookup_response=50;
    optional GrepRequest  grep_request=51;
    optional GrepResponse  grep_response=52;
    optional KeySpaceRequest  keyspace_request=53;
    optional KeySpaceResponse  keyspace_response=54;
    optional TopperTrendRequest  topper_trend_request=55;
    optional TopperTrendResponse  topper_trend_response=56;
    optional QueryPDPRequest query_pdp_request=57;
    optional QueryPDPResponse  query_pdp_response=58;
    optional SubscribeCtl  subscribe_ctl=59;
}

///////////////////////////////
// Hello 
message HelloRequest{
  required string   station_id=1;
}       

message HelloResponse{
  required string       trisul_id=1;
  required string       trisul_description=2;
  required string       connection_id=3;
  required string       version_string=4;
  required Timestamp    connection_start_time=5;
  required Timestamp    connection_up_time=6;
  required AuthLevel    current_auth_level=7;   
}

///////////////////////////////
// Error 
message ErrorResponse{
   required int64       original_command=1;
   required int64       error_code=2;
   required string      error_message=3;
}

///////////////////////////////
// OK 
message OKResponse{
   required int64       original_command=1;
   optional string      message=2;
}

message ReleaseContextRequest{
  optional int64        context=1;
}

///////////////////////////////
// CounterItemRequest 
message CounterItemRequest{
    optional int64          context=1 [default=0];
    required string         counter_group=2;
    optional int64          meter=3;
    required string         key=4;
    required TimeInterval   time_interval=5;
	optional int64			volumes_only=6 [default=0];
}

///////////////////////////////
// CounterItemResponse  
message CounterItemResponse{
    required KeyStats       stats=1;
}


//////////////////////////////////////////
// BulkCounterItemRequest
message BulkCounterItemRequest{
    optional int64          context=1[default=0];
    required string         counter_group=2;
    required int64          meter=3;
    required TimeInterval   time_interval=4;
    repeated string         keys=5;
}

//////////////////////////////////////////
// BulkCounterItemResponse
message BulkCounterItemResponse{
    repeated KeyStats       stats=1;
}

///////////////////////////////
// CounterGroupRequest 
message CounterGroupRequest{
    optional int64          context=1 [default=0];
    required string         counter_group=2;
    optional int64          meter=3 [default=0];
    optional int64          maxitems=4 [default=10];
    optional TimeInterval   time_interval=5;
    optional Timestamp      time_instant=6;
    optional int64          flags=7;
    optional bool           resolve_keys=8;
}

///////////////////////////////
// CounterGroupResponse  
message  CounterGroupResponse{
    required int64          context=1;
    required string         counter_group=2;
    required int64          meter=3;
	optional int64			sysgrouptotal=4;
    repeated KeyDetails     keys=6;
}


///////////////////////////////
// FilteredDatagramRequest
message FilteredDatagramRequest{
    optional int64          max_packets=1[default=0];                
    optional int64          max_bytes=2[default=0];                   
    optional CompressionType compress_type=3[default=UNCOMPRESSED];              

	// by trisul filter format expr
	message ByFilterExpr {
		required TimeInterval   time_interval=1;                   
		required string         filter_expression=2;
	}
	optional ByFilterExpr 		filter_expression=4;

	// by session
	message BySession   {
    	optional string         session_group=1[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
		repeated SessionID		session_ids=2;
	}
	optional BySession			session=5;


	// by alert
	message ByAlert     {
		optional string			alert_group=1[default="{9AFD8C08-07EB-47E0-BF05-28B4A7AE8DC9}"];
		repeated AlertID		alert_ids=2;
	}
	optional ByAlert			alert=6;

	// by resource
	message ByResource  {
		required string			resource_group=1;
		repeated ResourceID		resource_ids=2;
	}
	optional ByResource			resource=7;

    optional PcapDisposition    disposition=8[default=DOWNLOAD];              

}

/////////////////////////////////////
// FileredDatagaramResponse
message FilteredDatagramResponse{
    required PcapFormat     format=1;                                 
    required CompressionType compress_type=2;                   
    required TimeInterval   time_interval=3;                
    required int64          num_datagrams=4;               
    required int64          num_bytes=5;      
    required string         sha1=6;
    required bytes          contents=7;
	required PcapDisposition disposition=8;
	optional string			path=9;
}

//////////////////////////////////////////
// ControlledContextRequest
message ControlledContextRequest{
    required TimeInterval       time_interval=1;          
    required string             filter_expression=2;       
} 

//////////////////////////////////////////
//// ControlledContextResponse
message ControlledContextResponse{
    required int64              context=1;
    optional string             context_db=2;
    required TimeInterval       time_interval =3;          
} 

///////////////////////////////////////
// SearchkeysRequest
message SearchKeysRequest{
    optional int64          context=1[default=0];                    
    required string         counter_group=2;        
    required string         pattern=3;        
    required int64          maxitems=4;
} 

//////////////////////////////////////
// SearchKeysResponse
message SearchKeysResponse{
    optional int64          context=1;                    
    required string         counter_group=2;        
    repeated KeyDetails     found_keys=3;
} 

/////////////////////////////////////
/// CounterGroupInfoRequest
message CounterGroupInfoRequest{
    optional int64         context=1[default=0];
    optional string        counter_group=2;
	optional bool		   get_meter_info=3[default=false];
}

///////////////////////////////////
/// CounterGroupInfoResponse
message CounterGroupInfoResponse{
    optional int64                  context=1;
    repeated CounterGroupDetails    group_details=2;
}

/////////////////////////////////////
// SessionItemRequest
message SessionItemRequest{
    optional int64          context=1[default=0];            
    optional string         session_group=2[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
    repeated string         session_keys=3;
    repeated SessionID      session_ids=4;
	optional bool			resolve_keys=5[default=true];
}

////////////////////////////////////
// SessionItemResponse
message SessionItemResponse{
    optional int64          	context=1[default=0];            
    required string         	session_group=2;
    repeated SessionDetails     sessions=3;
}
///////////////////////////////////
// QuerySessions - any of the fields can be filled
// 				   all the fields filled are treated as AND criteria 
message QuerySessionsRequest {
    optional int64          context=1[default=0];
    optional string         session_group=2[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
    required TimeInterval   time_interval=3;
    optional string         key=4;
	optional string			source_ip=5;
	optional string			source_port=6;
	optional string			dest_ip=7;
	optional string			dest_port=8;
	optional string			any_ip=9;
	optional string			any_port=10;
	optional string			ip_pair=11;
	optional string			protocol=12;
	optional string			flowtag=13;
	optional string			nf_routerid=14;
	optional string			nf_ifindex_in=15;
	optional string			nf_ifindex_out=16;
	optional string			subnet_24=17;
	optional string			subnet_16=18;

    optional int64          maxitems=19[default=100];
    optional int64          volume_filter=20[default=0];
	optional bool			resolve_keys=21[default=true];
	optional string			outputpath=22;
}

/////////////////////////////////////
// QuerySessionsResponse 
message QuerySessionsResponse {
    optional int64          	context=1;
    required string         	session_group=2;
    repeated SessionDetails     sessions=3;
    optional string         	outputpath=4;
}

//////////////////////////////////////////////
/// UpdatekeysRequest
/// Response = OKResponse or ErrorResponse
message UpdateKeyRequest{
    optional int64          context=1[default=0];
    required string         counter_group=2;
    required string         key=4;
    required string         label=5;
    optional string         description=6;
}

/////////////////////////////////////
// SessionTrackerRequest
message SessionTrackerRequest {
    optional int64          context=1[default=0];
    optional string         session_group=2[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
    required int64          tracker_id=3 [default=1];
    optional int64          maxitems=4 [default=100];
    required TimeInterval   time_interval=5;
}

///////////////////////////////////
// SessionTrackerResponse 
message SessionTrackerResponse{
    optional int64          context=1;
    required string         session_group=2;
    repeated SessionDetails sessions=3;
    optional int64          tracker_id=4;
}

///////////////////////////////////
// SessionGroupRequest
message SessionGroupRequest {
    optional int64          context=1[default=0];
    optional string         session_group=2[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
    optional int64          tracker_id=3;
    optional string         key_filter=4;
    optional int64          maxitems=5 [default=100];
}

//////////////////////////////////
// SessionGroupResponse
message SessionGroupResponse {
    optional int64          context=1;
    required string         session_group=2;
    repeated string         session_keys=3;
}


//////////////////////////////////
// ServerStatsRequest
message ServerStatsRequest{
     required int64         param=1;
}

//////////////////////////////////
// ServerStatsResponse
message ServerStatsResponse{
    required string         instance_name=1;
    required int64          connections=2;
    required int64          uptime_seconds=3;
    required double         cpu_usage_percent_trisul=4;
    required double         cpu_usage_percent_total=5;
    required double         mem_usage_trisul=6;
    required double         mem_usage_total=7;
    required double         mem_total=8;
    required int64          size_total=9;
    required double         drop_percent_cap=11;
    required double         drop_percent_trisul=12;
    required TimeInterval   time_interval=13;
}

/////////////////////////////////////
// AlertItemRequest
message AlertItemRequest{
    optional int64          context=1[default=0];            
    required string         alert_group=2;
    repeated AlertID        alert_ids=3;
}
////////////////////////////////////
// AlertItemResponse
message AlertItemResponse{
    optional int64          context=1;            
    required string         alert_group=2;
    message Item {
        optional int64          sensor_id=1;
        required Timestamp      time=2;
		required AlertID		alert_id=3;
        optional string         source_ip=4;
        optional string         source_port=5;
        optional string         destination_ip=6;
        optional string         destination_port=7;
        required string         sigid=8;
        required string         classification=9;
        required string         priority=10;
        required Timestamp      dispatch_time=11;
        required string         aux_message1=12;
        required string         aux_message2=13;
    }
    repeated Item           items=3;
}

////////////////////////////////////
// AlertGroupQueryRequest
message AlertGroupRequest {
    optional int64          context=1[default=0];            
    required string         alert_group=2;
    required TimeInterval   time_interval=3;
    optional int64          maxitems=5 [default=10];
    optional string         source_ip=6;
    optional string         source_port=7;
    optional string         destination_ip=8;
    optional string         destination_port=9;
    optional string         sigid=10;
    optional string         classification=11;
    optional string         priority=12;
    optional string         aux_message1=13;
    optional string         aux_message2=14;
}

/////////////////////////////////////
// AlertGroupResponse 
message AlertGroupResponse {
    optional int64          context=1;
    required string         alert_group=2;
    repeated AlertID        alerts=3;
}

/////////////////////////////////////
// ResourceRequest - mutliple 
message ResourceItemRequest{
    optional int64          context=1[default=0];            
    required string         resource_group=2;
    repeated ResourceID     resource_ids=3;
}
////////////////////////////////////
// ResourceItemResponse
message ResourceItemResponse{
    optional int64          context=1;            
    required string         resource_group=2;
    message Item {
        required Timestamp      time=1;
        required ResourceID     resource_id=2;
        optional string         source_ip=3;
        optional string         source_port=4;
        optional string         destination_ip=5;
        optional string         destination_port=6;
        optional string         uri=7;
        optional string         userlabel=8;
    }
    repeated Item           items=3;
}

////////////////////////////////////
// ResourceGroupRequest
message ResourceGroupRequest {
    optional int64          context=1[default=0];            
    required string         resource_group=2;
    required TimeInterval   time_interval=3;
    optional int64          maxitems=4 [default=10];
    optional string         source_ip=5;
    optional string         source_port=6;
    optional string         destination_ip=7;
    optional string         destination_port=8;
    optional string         uri_pattern=9;
    optional string         userlabel_pattern=10;
    repeated string         uri_list=11;
}

/////////////////////////////////////
// ResourceGroupResponse  
message ResourceGroupResponse {
    optional int64          context=1;
    required string         resource_group=2;
    repeated ResourceID     resources=3;
}



/////////////////////////////////////////////
// KeyLookup - mutliple keys from a single CG
message KeyLookupRequest {
    optional int64          context=1[default=0];            
    required string         counter_group=2;
    repeated string         keys=3;
}


/////////////////////////////////////////////
// KeyLookup 
message KeyLookupResponse {
    optional int64          context=1;            
    required string         counter_group=2;
    repeated KeyDetails     key_details=3;
}

////////////////////////////////////
// GrepRequest
message GrepRequest {
    optional int64          context=1[default=0];            
    optional string         session_group=2[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
    required TimeInterval   time_interval=3;
    optional int64          maxitems=4 [default=50];
    optional string         pattern=5;
	repeated string         md5list=6;
}

/////////////////////////////////////
// GrepResponse  
message GrepResponse  {
    optional int64          context=1;
    optional string         session_group=2[default="{99A78737-4B41-4387-8F31-8077DB917336}"];
    repeated SessionDetails sessions=3;
    repeated string         hints=4;
}


////////////////////////////////////
// KeySpaceRequest
message KeySpaceRequest {
    optional int64          context=1[default=0];            
    required string         counter_group=2;
    required TimeInterval   time_interval=3;
    optional int64          maxitems=4 [default=100];

	message KeySpace {
		required string 	from=1;
		required string 	to=2;
	}

	repeated KeySpace       spaces=5;
}

/////////////////////////////////////
// KeySpaceResponse  
message KeySpaceResponse  {
    optional int64          context=1;
    optional string         counter_group=2;
    repeated string         hits=3;
}

///////////////////////////////
// TopperTrendRequest 
message TopperTrendRequest {
    optional int64          context=1 [default=0];
    required string         counter_group=2;
    optional int64          meter=3 [default=0];
    optional int64          maxitems=4 [default=10];
    optional TimeInterval   time_interval=5;
}

///////////////////////////////
// TopperTrendResponse   
message  TopperTrendResponse {
    required int64          context=1;
    required string         counter_group=2;
    required int64          meter=3;
    repeated KeyStats       keytrends=4;
}

///////////////////////////////////
// QueryPDP - any of the fields can be filled
// 				   all the fields filled are treated as AND criteria 
// {3fcbae7f-bbec-47ca-bae0-b48d5f96fd6b}
// define_guid(<<name>>, 
// 0x3fcbae7f, 0xbbec, 0x47ca, 0xba, 0xe0, 0xb4, 0x8d, 0x5f, 0x96, 0xfd, 0x6b);

message QueryPDPRequest {
    optional int64          context=1[default=0];
    optional string         session_group=2[default="{3FCBAE7F-BBEC-47CA-BAE0-B48D5F96FD6B}"];
    required TimeInterval   time_interval=3;
	optional string			ipa=4;
	optional string			msisdn=5;
	optional string			imei=6;
	optional string			imsi=7;
	optional string			apn=8;
	optional string			rai=9;
	optional string			uli=10;
	optional string			rat=11;
	optional string			cause=12;
	optional string			mccmnc=13;
    optional int64          maxitems=14[default=100];
	optional string			teid=15;
}

/////////////////////////////////////
// QueryPDPResponse 
message QueryPDPResponse {
    optional int64          	context=1;
    repeated PDPDetails         sessions=3;
}




///////////////////////////////////
// Subscribe - add a subcription to the Real Time channel
message SubscribeCtl  {

	// from TrisulAPI 
	enum StabberType 
	{
		ST_COUNTER_ITEM=0;
		ST_ALERT=1;			
		ST_FLOW=2;         
		ST_TOPPER=3;     
	}

	enum CtlType
	{
		CT_SUBSCRIBE=0;
		CT_UNSUBSCRIBE=1;
	}

    optional int64          context=1[default=0];
	required CtlType		ctl=2;
	required StabberType	type=3;
	optional string			guid=4;
	optional string			key=5;
	optional int64			meterid=6;
}


